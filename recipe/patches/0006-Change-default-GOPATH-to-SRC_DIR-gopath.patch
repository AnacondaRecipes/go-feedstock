From 33fb371e5e381e6048b2a6baab986d4cb0b4dbcf Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Patrick=20Sodr=C3=A9?= <psodre@gmail.com>
Date: Sat, 18 Apr 2020 22:18:19 -0400
Subject: [PATCH 6/6] Change default GOPATH to $SRC_DIR/gopath

---
 src/go/build/build.go | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/src/go/build/build.go b/src/go/build/build.go
index aa7371e102..fee64d5d1b 100644
--- a/src/go/build/build.go
+++ b/src/go/build/build.go
@@ -265,7 +265,10 @@ var Default Context = defaultContext()
 
 func defaultCondaGOPATH() string {
 	if envIsOne("CONDA_GO_COMPILER") && envIsOne("CONDA_BUILD") {
-		return envOr("SRC_DIR", defaultGOPATH())
+		if srcDir := os.Getenv("SRC_DIR"); srcDir != "" {
+			return filepath.Join(srcDir, "gopath")
+		}
+		return defaultGOPATH()
 	}
 	return defaultGOPATH()
 }
@@ -348,7 +351,6 @@ func envIsOne(name string) bool {
 	return s == "1"
 }
 
-
 // An ImportMode controls the behavior of the Import method.
 type ImportMode uint
 
-- 
2.26.0

